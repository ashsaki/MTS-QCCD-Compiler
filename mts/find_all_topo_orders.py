class Graph:
    def __init__(self, edges, N):
        self.edge_list = [[] for _ in range(N)]
        self.N = N
        self.indegree = [0] * N

        for (src, dest) in edges:
            self.edge_list[src].append(dest)
            self.indegree[dest] = self.indegree[dest] + 1

global count
count = 1
def findAllTopologicalOrders(graph, path, discovered, N):
    global count
    # do for every vertex
    for v in range(N):
 
        # proceed only if in-degree of current node is 0 and
        # current node is not processed yet
        if graph.indegree[v] == 0 and not discovered[v]:
 
            # for every adjacent vertex u of v,
            # reduce in-degree of u by 1
            for u in graph.edge_list[v]:
                graph.indegree[u] = graph.indegree[u] - 1
 
            # include current node in the path
            # and mark it as discovered
            path.append(v)
            discovered[v] = True
 
            # recur
            findAllTopologicalOrders(graph, path, discovered, N)
 
            # backtrack: reset in-degree
            # information for the current node
            for u in graph.edge_list[v]:
                graph.indegree[u] = graph.indegree[u] + 1
 
            # backtrack: remove current node from the path and
            # mark it as undiscovered
            path.pop()
            discovered[v] = False
 
    # print the topological order if
    # all vertices are included in the path
    if len(path) == N:
        print(count)
        count += 1

def printAllTopologicalOrders(graph):
 
    # get number of nodes in the graph
    N = len(graph.edge_list)
 
    # create an auxiliary space to keep track of whether vertex is discovered
    discovered = [False] * N
 
    # list to store the topological order
    path = []
 
    # find all topological ordering and print them
    findAllTopologicalOrders(graph, path, discovered, N)

if __name__ == '__main__':
 
    # List of graph edges as per above diagram
    edges = [(4, 16), (4, 31), (16, 40), (16, 97), (8, 17), (8, 42), (17, 34), (17, 41), (12, 18), (12, 37), (18, 42), (18, 99), (1, 19), (1, 29), (19, 31), (19, 44), (5, 20), (5, 76), (20, 32), (20, 65), (9, 21), (9, 35), (21, 37), (21, 46), (6, 22), (6, 33), (22, 29), (22, 88), (10, 23), (10, 50), (23, 36), (23, 49), (14, 24), (14, 39), (24, 35), (24, 94), (3, 25), (3, 81), (25, 33), (25, 52), (7, 26), (7, 82), (26, 53), (26, 67), (11, 27), (11, 83), (27, 39), (27, 54), (0, 28), (0, 40), (28, 44), (28, 96), (29, 48), (29, 75), (2, 30), (2, 48), (30, 52), (30, 104), (31, 41), (31, 61), (32, 45), (32, 62), (33, 49), (33, 63), (34, 46), (34, 98), (35, 50), (35, 77), (36, 54), (36, 106), (37, 43), (37, 69), (13, 38), (13, 93), (38, 47), (38, 70), (39, 51), (39, 71), (40, 56), (40, 168), (41, 60), (41, 72), (42, 64), (42, 73), (43, 68), (43, 74), (44, 57), (44, 84), (45, 61), (45, 173), (46, 65), (46, 90), (47, 69), (47, 175), (48, 58), (48, 85), (49, 62), (49, 78), (50, 66), (50, 79), (51, 70), (51, 80), (52, 59), (52, 86), (53, 63), (53, 181), (54, 67), (54, 92), (15, 55), (15, 95), (55, 71), (55, 183), (56, 72), (56, 152), (57, 85), (57, 153), (58, 78), (58, 154), (59, 108), (59, 155), (60, 73), (60, 87), (61, 75), (61, 101), (62, 79), (62, 89), (63, 81), (63, 109), (64, 74), (64, 160), (65, 76), (65, 91), (66, 80), (66, 162), (67, 82), (67, 110), (68, 93), (68, 99), (69, 77), (69, 103), (70, 95), (70, 107), (71, 83), (71, 111), (72, 84), (72, 140), (73, 97), (73, 141), (74, 90), (74, 142), (75, 88), (75, 100), (76, 87), (76, 144), (77, 94), (77, 102), (78, 86), (78, 146), (79, 91), (79, 105), (80, 92), (80, 148), (81, 108), (81, 149), (82, 89), (82, 150), (83, 110), (83, 151), (84, 96), (84, 128), (85, 100), (85, 129), (86, 104), (86, 130), (87, 101), (87, 131), (88, 105), (88, 132), (89, 109), (89, 133), (90, 98), (90, 134), (91, 102), (91, 135), (92, 106), (92, 136), (93, 103), (93, 137), (94, 107), (94, 138), (95, 111), (95, 139), (96, 112), (97, 113), (98, 114), (99, 115), (100, 116), (101, 117), (102, 118), (103, 119), (104, 120), (105, 121), (106, 122), (107, 123), (108, 124), (109, 125), (110, 126), (111, 127), (112, 128), (112, 184), (113, 141), (113, 196), (114, 134), (114, 190), (115, 164), (115, 198), (116, 129), (116, 143), (117, 131), (117, 157), (118, 135), (118, 145), (119, 137), (119, 165), (120, 130), (120, 186), (121, 132), (121, 147), (122, 136), (122, 192), (123, 138), (123, 166), (124, 149), (124, 155), (125, 133), (125, 159), (126, 151), (126, 163), (127, 139), (127, 167), (128, 140), (128, 172), (129, 153), (129, 176), (130, 146), (130, 180), (131, 144), (131, 156), (132, 143), (132, 202), (133, 150), (133, 158), (134, 142), (134, 174), (135, 147), (135, 161), (136, 148), (136, 182), (137, 164), (137, 221), (138, 145), (138, 204), (139, 166), (139, 223), (140, 152), (140, 169), (141, 156), (141, 170), (142, 160), (142, 171), (143, 157), (143, 185), (144, 161), (144, 213), (145, 165), (145, 191), (146, 154), (146, 177), (147, 158), (147, 178), (148, 162), (148, 179), (149, 159), (149, 211), (150, 163), (150, 215), (151, 167), (151, 219), (152, 168), (152, 280), (153, 172), (153, 281), (154, 176), (154, 282), (155, 180), (155, 283), (156, 169), (156, 284), (157, 173), (157, 187), (158, 177), (158, 188), (159, 181), (159, 189), (160, 170), (160, 288), (161, 174), (161, 200), (162, 178), (162, 290), (163, 182), (163, 206), (164, 171), (164, 292), (165, 175), (165, 193), (166, 179), (166, 194), (167, 183), (167, 195), (168, 196), (168, 208), (169, 187), (169, 197), (170, 198), (170, 216), (171, 193), (171, 267), (172, 184), (172, 199), (173, 188), (173, 269), (174, 190), (174, 201), (175, 194), (175, 271), (176, 185), (176, 210), (177, 189), (177, 203), (178, 191), (178, 218), (179, 195), (179, 275), (180, 186), (180, 205), (181, 206), (181, 277), (182, 192), (182, 207), (183, 223), (183, 279), (184, 208), (184, 252), (185, 202), (185, 209), (186, 210), (186, 254), (187, 199), (187, 212), (188, 200), (188, 256), (189, 205), (189, 214), (190, 197), (190, 258), (191, 204), (191, 217), (192, 203), (192, 260), (193, 201), (193, 220), (194, 221), (194, 262), (195, 207), (195, 222), (196, 212), (196, 240), (197, 216), (197, 241), (198, 220), (198, 242), (199, 209), (199, 243), (200, 213), (200, 244), (201, 217), (201, 245), (202, 214), (202, 246), (203, 218), (203, 247), (204, 222), (204, 248), (205, 211), (205, 249), (206, 215), (206, 250), (207, 219), (207, 251), (208, 224), (209, 225), (210, 226), (211, 227), (212, 228), (213, 229), (214, 230), (215, 231), (216, 232), (217, 233), (218, 234), (219, 235), (220, 236), (221, 237), (222, 238), (223, 239), (224, 252), (224, 264), (225, 243), (225, 253), (226, 254), (226, 272), (227, 249), (227, 305), (228, 240), (228, 255), (229, 244), (229, 300), (230, 246), (230, 257), (231, 250), (231, 306), (232, 241), (232, 266), (233, 245), (233, 259), (234, 247), (234, 274), (235, 251), (235, 307), (236, 242), (236, 261), (237, 262), (237, 317), (238, 248), (238, 263), (239, 279), (239, 319), (240, 264), (240, 321), (241, 258), (241, 265), (242, 266), (242, 323), (243, 255), (243, 268), (244, 256), (244, 289), (245, 261), (245, 270), (246, 253), (246, 312), (247, 260), (247, 273), (248, 259), (248, 318), (249, 257), (249, 276), (250, 277), (250, 291), (251, 263), (251, 278), (252, 268), (252, 320), (253, 272), (253, 299), (254, 276), (254, 328), (255, 265), (255, 285), (256, 269), (256, 286), (257, 273), (257, 287), (258, 270), (258, 322), (259, 274), (259, 301), (260, 278), (260, 330), (261, 267), (261, 293), (262, 271), (262, 294), (263, 275), (263, 295), (264, 280), (264, 392), (265, 284), (265, 296), (266, 288), (266, 297), (267, 292), (267, 298), (268, 281), (268, 308), (269, 285), (269, 397), (270, 289), (270, 314), (271, 293), (271, 399), (272, 282), (272, 309), (273, 286), (273, 302), (274, 290), (274, 303), (275, 294), (275, 304), (276, 283), (276, 310), (277, 287), (277, 405), (278, 291), (278, 316), (279, 295), (279, 407), (280, 296), (280, 376), (281, 309), (281, 377), (282, 302), (282, 378), (283, 332), (283, 379), (284, 297), (284, 311), (285, 299), (285, 325), (286, 303), (286, 313), (287, 305), (287, 333), (288, 298), (288, 384), (289, 300), (289, 315), (290, 304), (290, 386), (291, 306), (291, 334), (292, 317), (292, 323), (293, 301), (293, 327), (294, 319), (294, 331), (295, 307), (295, 335), (296, 308), (296, 364), (297, 321), (297, 365), (298, 314), (298, 366), (299, 312), (299, 324), (300, 311), (300, 368), (301, 318), (301, 326), (302, 310), (302, 370), (303, 315), (303, 329), (304, 316), (304, 372), (305, 332), (305, 373), (306, 313), (306, 374), (307, 334), (307, 375), (308, 320), (308, 352), (309, 324), (309, 353), (310, 328), (310, 354), (311, 325), (311, 355), (312, 329), (312, 356), (313, 333), (313, 357), (314, 322), (314, 358), (315, 326), (315, 359), (316, 330), (316, 360), (317, 327), (317, 361), (318, 331), (318, 362), (319, 335), (319, 363), (320, 336), (321, 337), (322, 338), (323, 339), (324, 340), (325, 341), (326, 342), (327, 343), (328, 344), (329, 345), (330, 346), (331, 347), (332, 348), (333, 349), (334, 350), (335, 351), (336, 352), (336, 408), (337, 365), (337, 420), (338, 358), (338, 414), (339, 388), (339, 422), (340, 353), (340, 367), (341, 355), (341, 381), (342, 359), (342, 369), (343, 361), (343, 389), (344, 354), (344, 410), (345, 356), (345, 371), (346, 360), (346, 416), (347, 362), (347, 390), (348, 373), (348, 379), (349, 357), (349, 383), (350, 375), (350, 387), (351, 363), (351, 391), (352, 364), (352, 396), (353, 377), (353, 400), (354, 370), (354, 404), (355, 368), (355, 380), (356, 367), (356, 426), (357, 374), (357, 382), (358, 366), (358, 398), (359, 371), (359, 385), (360, 372), (360, 406), (361, 388), (361, 445), (362, 369), (362, 428), (363, 390), (363, 447), (364, 376), (364, 393), (365, 380), (365, 394), (366, 384), (366, 395), (367, 381), (367, 409), (368, 385), (368, 437), (369, 389), (369, 415), (370, 378), (370, 401), (371, 382), (371, 402), (372, 386), (372, 403), (373, 383), (373, 435), (374, 387), (374, 439), (375, 391), (375, 443), (376, 392), (376, 504), (377, 396), (377, 505), (378, 400), (378, 506), (379, 404), (379, 507), (380, 393), (380, 508), (381, 397), (381, 411), (382, 401), (382, 412), (383, 405), (383, 413), (384, 394), (384, 512), (385, 398), (385, 424), (386, 402), (386, 514), (387, 406), (387, 430), (388, 395), (388, 516), (389, 399), (389, 417), (390, 403), (390, 418), (391, 407), (391, 419), (392, 420), (392, 432), (393, 411), (393, 421), (394, 422), (394, 440), (395, 417), (395, 491), (396, 408), (396, 423), (397, 412), (397, 493), (398, 414), (398, 425), (399, 418), (399, 495), (400, 409), (400, 434), (401, 413), (401, 427), (402, 415), (402, 442), (403, 419), (403, 499), (404, 410), (404, 429), (405, 430), (405, 501), (406, 416), (406, 431), (407, 447), (407, 503), (408, 432), (408, 476), (409, 426), (409, 433), (410, 434), (410, 478), (411, 423), (411, 436), (412, 424), (412, 480), (413, 429), (413, 438), (414, 421), (414, 482), (415, 428), (415, 441), (416, 427), (416, 484), (417, 425), (417, 444), (418, 445), (418, 486), (419, 431), (419, 446), (420, 436), (420, 464), (421, 440), (421, 465), (422, 444), (422, 466), (423, 433), (423, 467), (424, 437), (424, 468), (425, 441), (425, 469), (426, 438), (426, 470), (427, 442), (427, 471), (428, 446), (428, 472), (429, 435), (429, 473), (430, 439), (430, 474), (431, 443), (431, 475), (432, 448), (433, 449), (434, 450), (435, 451), (436, 452), (437, 453), (438, 454), (439, 455), (440, 456), (441, 457), (442, 458), (443, 459), (444, 460), (445, 461), (446, 462), (447, 463), (448, 476), (448, 488), (449, 467), (449, 477), (450, 478), (450, 496), (451, 473), (451, 529), (452, 464), (452, 479), (453, 468), (453, 524), (454, 470), (454, 481), (455, 474), (455, 530), (456, 465), (456, 490), (457, 469), (457, 483), (458, 471), (458, 498), (459, 475), (459, 531), (460, 466), 
        (460, 485), (461, 486), (461, 541), (462, 472), (462, 487), (463, 503), (463, 543), (464, 488), (464, 545), (465, 482), (465, 489), (466, 490), (466, 547), (467, 479), (467, 492), (468, 480), (468, 513), (469, 485), (469, 494), (470, 477), (470, 536), (471, 484), (471, 497), (472, 483), (472, 542), (473, 481), (473, 500), (474, 501), (474, 515), (475, 487), (475, 502), (476, 492), (476, 544), (477, 496), (477, 523), (478, 500), (478, 552), (479, 489), (479, 509), (480, 493), (480, 510), (481, 497), (481, 511), (482, 494), (482, 546), (483, 498), (483, 525), (484, 502), (484, 554), (485, 491), (485, 517), (486, 495), (486, 518), (487, 499), (487, 519), (488, 504), (489, 508), (489, 520), (490, 512), (490, 521), (491, 516), (491, 522), (492, 505), (492, 532), (493, 509), (494, 513), (494, 538), (495, 517), (496, 506), (496, 533), (497, 510), (497, 526), (498, 514), (498, 527), (499, 518), (499, 528), (500, 507), (500, 534), (501, 511), (502, 515), (502, 540), (503, 519), (504, 520), (505, 533), (506, 526), (507, 556), (508, 521), (508, 535), (509, 523), (509, 549), (510, 527), (510, 537), (511, 529), (511, 557), (512, 522), (513, 524), (513, 539), (514, 528), (515, 530), (515, 558), (516, 541), (516, 547), (517, 525), (517, 551), (518, 543), (518, 555), (519, 531), (519, 559), (520, 532), (521, 545), (522, 538), (523, 536), (523, 548), (524, 535), (525, 542), (525, 550), (526, 534), (527, 539), (527, 553), (528, 540), (529, 556), (530, 537), (531, 558), (532, 544), (533, 548), (534, 552), (535, 549), (536, 553), (537, 557), (538, 546), (539, 550), (540, 554), (541, 551), (542, 555), (543, 559)]
 
    print("All Topological sorts")
 
    # Number of nodes in the graph
    N = 560
 
    # create a graph from edges
    graph = Graph(edges, N)
 
    # print all topological ordering of the graph
    printAllTopologicalOrders(graph)